/*  
  Requires the Kubernetes plugin to be installed in Jenkins 
  and Jenkins itself to be running within a Kubernetes cluster.
*/

pipeline {

    agent {
        kubernetes {
            yamlFile 'KubernetesPod.yaml'
        }
    }

    stages { 

        stage('test k8s commands') {
            git url: 'https://github.com/abbassizied/angular-cicd-k8s.git', branch: 'main'
            container('cicd-toolbox') {
                    // echo POD_CONTAINER // displays 'busybox'
                    // sh 'hostname'                   
                    sh 'helm upgrade --install angular -n jenkins ./helm/angularchart'
                    // Uncomment the following line to check the Node.js version
                    // sh 'node --version'
            }
        }
        
    }
}
